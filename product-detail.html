<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Detalles del Producto - CAD Assets Store</title>
    <style>
        :root{--bg:#0a0a0a;--panel:rgba(255,255,255,0.03);--accent1:#667eea;--accent2:#764ba2;--muted:#888}
        *{box-sizing:border-box}
        body{font-family:'Segoe UI',Tahoma,Arial;background:var(--bg);color:#fff;margin:0;padding:0}
        header{position:fixed;top:0;width:100%;padding:.8rem 3%;background:rgba(10,10,10,0.95);backdrop-filter:blur(10px);border-bottom:1px solid rgba(255,255,255,0.06);z-index:100;display:flex;justify-content:space-between;align-items:center}
        .logo{font-weight:700;background:linear-gradient(135deg,var(--accent1),var(--accent2));-webkit-background-clip:text;-webkit-text-fill-color:transparent}
        .back-btn{cursor:pointer;padding:.4rem .8rem;background:transparent;border:1px solid rgba(255,255,255,0.06);color:#fff;border-radius:8px;font-size:.9rem}
        .back-btn:hover{border-color:var(--accent1);color:var(--accent1)}
        .cart-icon{position:relative;cursor:pointer;margin-right:1rem}
        .cart-count{position:absolute;top:-6px;right:-6px;background:linear-gradient(135deg,var(--accent1),var(--accent2));width:22px;height:22px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:.8rem;color:#fff}
        main{padding:80px 3% 40px;max-width:1400px;margin:0 auto}
        .content{display:grid;grid-template-columns:1fr 1fr;gap:3rem}
        .preview{background:var(--panel);border:1px solid rgba(255,255,255,0.04);border-radius:12px;padding:2rem;display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:500px}
        .canvas-3d{width:100%;height:400px;border-radius:8px;background:linear-gradient(135deg,rgba(102,126,234,0.08),rgba(118,75,162,0.08));display:flex;align-items:center;justify-content:center;font-size:4rem;margin-bottom:1rem;user-select:none;cursor:grab}
        .canvas-3d:active{cursor:grabbing}
        .preview-controls{display:flex;gap:.5rem;justify-content:center;margin-top:1rem;font-size:.9rem;color:var(--muted)}
        .info h1{font-size:2rem;margin:0 0 1rem}
        .badge{display:inline-block;background:rgba(102,126,234,0.12);color:var(--accent1);padding:.3rem .8rem;border-radius:999px;font-size:.85rem;margin-bottom:1rem}
        .price{font-size:2.5rem;font-weight:700;color:var(--accent1);margin:1rem 0}
        .rating{color:var(--muted);margin-bottom:1rem}
        .rating span{color:#ffc107;margin-right:.5rem}
        .tabs{display:flex;gap:1rem;border-bottom:1px solid rgba(255,255,255,0.04);margin:2rem 0 1rem}
        .tab{padding:.8rem 1rem;border:none;background:transparent;color:var(--muted);cursor:pointer;border-bottom:2px solid transparent;transition:all .2s}
        .tab.active{color:#fff;border-bottom-color:var(--accent1)}
        .tab-content{display:none}
        .tab-content.active{display:block}
        .specs{display:grid;grid-template-columns:repeat(2,1fr);gap:1rem;margin-top:1rem}
        .spec-item{background:var(--panel);padding:1rem;border-radius:8px;border:1px solid rgba(255,255,255,0.04)}
        .spec-label{color:var(--muted);font-size:.9rem}
        .spec-value{font-weight:700;color:#fff;margin-top:.3rem}
        .features-list{list-style:none;padding:0;margin:1rem 0}
        .features-list li{padding:.5rem 0;color:#b0b0b0;display:flex;align-items:center;gap:.5rem}
        .features-list li:before{content:'‚úì';color:var(--accent1);font-weight:700}
        .actions{display:flex;gap:1rem;margin-top:2rem}
        .btn{cursor:pointer;border:none;border-radius:10px;padding:.8rem 1.5rem;font-weight:600;transition:all .2s}
        .btn-primary{background:linear-gradient(135deg,var(--accent1),var(--accent2));color:#fff}
        .btn-primary:hover{transform:translateY(-2px);box-shadow:0 10px 25px rgba(102,126,234,0.3)}
        .btn-secondary{background:transparent;border:1px solid rgba(255,255,255,0.1);color:#fff}
        .btn-secondary:hover{border-color:var(--accent1);color:var(--accent1)}
        .qty-selector{display:flex;align-items:center;gap:.5rem;background:var(--panel);padding:.4rem;border-radius:8px;width:fit-content}
        .qty-btn{background:transparent;border:1px solid rgba(255,255,255,0.1);color:#fff;width:32px;height:32px;cursor:pointer;border-radius:4px;font-weight:700}
        .qty-btn:hover{border-color:var(--accent1)}
        .qty-display{min-width:40px;text-align:center;font-weight:700}
        /* Cart modal styles */
        .cart-modal{position:fixed;right:-420px;top:0;width:420px;height:100vh;background:rgba(10,10,10,0.98);border-left:1px solid rgba(255,255,255,0.06);z-index:999;transition:right .28s;display:flex;flex-direction:column}
        .cart-modal.active{right:0}
        .cart-overlay{position:fixed;inset:0;background:rgba(0,0,0,.45);opacity:0;pointer-events:none;transition:opacity .2s;z-index:998}
        .cart-overlay.active{opacity:1;pointer-events:auto}
        .cart-header{padding:1.2rem;border-bottom:1px solid rgba(255,255,255,0.06);display:flex;justify-content:space-between;align-items:center}
        .cart-items{padding:1rem;overflow:auto;flex:1}
        .cart-footer{padding:1rem;border-top:1px solid rgba(255,255,255,0.06)}
        .cart-empty{color:var(--muted);text-align:center}
        @media(max-width:1024px){.content{grid-template-columns:1fr;gap:2rem}.specs{grid-template-columns:1fr}}

        /* Image Gallery Styles */
        .gallery-container{position:relative;width:100%;height:400px;border-radius:8px;overflow:hidden;background:var(--panel)}
        .gallery-main{position:relative;width:100%;height:100%;overflow:hidden}
        .gallery-main img{width:100%;height:100%;object-fit:cover;transition:transform 0.3s ease}
        .gallery-nav{position:absolute;top:50%;transform:translateY(-50%);width:100%;display:flex;justify-content:space-between;padding:0 1rem;z-index:2}
        .gallery-nav button{background:rgba(0,0,0,0.5);border:none;color:white;width:40px;height:40px;border-radius:50%;cursor:pointer;font-size:18px;display:flex;align-items:center;justify-content:center;transition:background 0.2s}
        .gallery-nav button:hover{background:rgba(0,0,0,0.8)}
        .gallery-thumbnails{position:absolute;bottom:10px;left:50%;transform:translateX(-50%);display:flex;gap:8px;z-index:2}
        .gallery-thumbnails img{width:60px;height:40px;object-fit:cover;border-radius:4px;cursor:pointer;opacity:0.6;border:2px solid transparent;transition:all 0.2s}
        .gallery-thumbnails img.active{opacity:1;border-color:var(--accent1)}
        .gallery-thumbnails img:hover{opacity:0.8}

        /* Lightbox Styles */
        .lightbox{position:fixed;inset:0;background:rgba(0,0,0,0.9);display:none;z-index:10000;align-items:center;justify-content:center}
        .lightbox.active{display:flex}
        .lightbox img{max-width:90%;max-height:90%;object-fit:contain}
        .lightbox-close{position:absolute;top:20px;right:20px;background:rgba(0,0,0,0.5);border:none;color:white;width:40px;height:40px;border-radius:50%;cursor:pointer;font-size:24px;z-index:10001}
        .lightbox-nav{position:absolute;top:50%;transform:translateY(-50%);width:100%;display:flex;justify-content:space-between;padding:0 2rem;z-index:10001}
        .lightbox-nav button{background:rgba(0,0,0,0.5);border:none;color:white;width:50px;height:50px;border-radius:50%;cursor:pointer;font-size:24px;display:flex;align-items:center;justify-content:center;transition:background 0.2s}
        .lightbox-nav button:hover{background:rgba(0,0,0,0.8)}
    </style>
</head>
<body>
    <header>
        <div class="logo">trEdion CAD Assets Store</div>
        <div style="display:flex;align-items:center">
            <div class="cart-icon" onclick="toggleCart()">üõí<div id="cart-count" class="cart-count" style="display:none">0</div></div>
            <button class="back-btn" onclick="history.back()">‚Üê Atr√°s</button>
        </div>
    </header>

    <main>
        <div class="content">
            <!-- Galer√≠a de Im√°genes -->
            <div class="preview">
                <div id="gallery-container" class="gallery-container">
                    <div class="gallery-main">
                        <img id="gallery-main-img" src="" alt="Producto">
                        <div class="gallery-nav">
                            <button id="gallery-prev" onclick="changeImage(-1)">‚Äπ</button>
                            <button id="gallery-next" onclick="changeImage(1)">‚Ä∫</button>
                        </div>
                        <div id="gallery-thumbnails" class="gallery-thumbnails"></div>
                    </div>
                </div>
                <div class="preview-controls">
                    <span>Haz clic en las miniaturas para cambiar ‚Ä¢ Click en imagen para zoom</span>
                </div>
            </div>

            <!-- Informaci√≥n del producto -->
            <div class="info">
                <span class="badge" id="product-badge"></span>
                <h1 id="product-name"></h1>
                <div class="rating">
                    <span id="product-rating">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</span>
                    <span id="product-reviews">(42 rese√±as)</span>
                </div>
                <div class="price" id="product-price"></div>

                <!-- Tabs -->
                <div class="tabs">
                    <button class="tab active" onclick="switchTab('overview')">Descripci√≥n</button>
                    <button class="tab" onclick="switchTab('specs')">Especificaciones</button>
                    <button class="tab" onclick="switchTab('features')">Caracter√≠sticas</button>
                </div>

                <!-- Contenido de tabs -->
                <div id="overview" class="tab-content active">
                    <p id="product-description" style="color:#b0b0b0;line-height:1.6"></p>
                </div>

                <div id="specs" class="tab-content">
                    <div class="specs" id="specs-grid"></div>
                </div>

                <div id="features" class="tab-content">
                    <ul class="features-list" id="features-list"></ul>
                </div>

                <!-- Selector de cantidad y botones -->
                <div style="margin-top:2rem">
                    <div style="margin-bottom:1rem">
                        <div style="color:var(--muted);margin-bottom:.5rem;font-size:.9rem">Cantidad:</div>
                        <div class="qty-selector">
                            <button class="qty-btn" onclick="decreaseQty()">‚àí</button>
                            <span class="qty-display" id="qty">1</span>
                            <button class="qty-btn" onclick="increaseQty()">+</button>
                        </div>
                    </div>
                </div>

                <div class="actions">
                    <button class="btn btn-primary" style="flex:1" onclick="addToCartFinal()">Agregar al Carrito</button>
                    <button class="btn btn-secondary" onclick="toggleCart()">Ver Carrito</button>
                </div>
            </div>
        </div>
    </main>

    <!-- Cart modal -->
    <div id="cart-overlay" class="cart-overlay" onclick="toggleCart()"></div>
    <aside id="cart-modal" class="cart-modal">
        <div class="cart-header"><strong>Mi Carrito</strong><button onclick="toggleCart()" class="btn" style="background:transparent;border:none;color:#fff;cursor:pointer">‚úï</button></div>
        <div id="cart-items" class="cart-items"><div class="cart-empty">Tu carrito est√° vac√≠o</div></div>
        <div class="cart-footer">
            <div style="display:flex;justify-content:space-between;margin-bottom:.6rem"><span>Subtotal</span><span id="subtotal">$0.00</span></div>
            <div style="display:flex;justify-content:space-between;margin-bottom:.6rem"><span>Impuesto (10%)</span><span id="tax">$0.00</span></div>
            <div style="display:flex;justify-content:space-between;font-weight:700;margin-bottom:.6rem"><span>Total</span><span id="total">$0.00</span></div>
            <div style="display:flex;gap:.5rem"><button class="btn" onclick="toggleCart()" style="flex:1;background:transparent;border:1px solid rgba(255,255,255,0.06);color:#fff">Seguir comprando</button><button class="btn btn-primary" style="flex:1" onclick="checkout()">Checkout</button></div>
        </div>
    </aside>

    <script>
        // Extended product data
        const productsDB = {
            1: {name:'Plano El√©ctrico Casa 3 Dormitorios',price:29.99,category:'Planos El√©ctricos',format:'AutoCAD',badge:'AutoCAD',desc:'Instalaci√≥n el√©ctrica completa para una casa de 3 dormitorios, incluye iluminaci√≥n, tomacorrientes, tablero principal y circuitos de seguridad con documentaci√≥n t√©cnica detallada.',longDesc:'Plano profesional de instalaci√≥n el√©ctrica residencial. Incluye: distribuci√≥n de circuitos, diagrama unifilar, especificaciones de materiales, normas de seguridad NEC aplicables y detalles de conexi√≥n. Perfectamente dimensionado y listo para presentaci√≥n a contratistas o supervisores de obra.',specs:{Software:'AutoCAD 2020+',Escala:'1:50',Formato:'DWG + PDF','Resoluci√≥n':'2560x1920px','Peso del archivo':'2.4 MB'},features:['Plano a escala profesional','Especificaciones t√©cnicas completas','Normas el√©ctricas vigentes','Detalles de conexi√≥n','Diagrama unifilar incluido','Simbolog√≠a est√°ndar NEC','Listo para impresi√≥n'],images:['https://images.unsplash.com/photo-1581094794329-c8112a89af12?w=800','https://images.unsplash.com/photo-1558618666-fcd25c85cd64?w=800','https://images.unsplash.com/photo-1581291518857-4e27b48ff24e?w=800','https://images.unsplash.com/photo-1581094794329-c8112a89af12?w=800']},
            2: {name:'Transformador Trif√°sico 500 KVA',price:79.99,category:'Transformadores',format:'SolidWorks',badge:'SolidWorks 3D',desc:'Modelo 3D completo de transformador trif√°sico con ensamblaje de n√∫cleo, bobinas y componentes. Incluye planos t√©cnicos, especificaciones el√©ctricas y lista de materiales.',longDesc:'Modelo 3D param√©trico y altamente detallado de un transformador trif√°sico industrial de 500 KVA. Incluye componentes internos: n√∫cleo laminado, bobinas primarias y secundarias, radiadores de refrigeraci√≥n y aisladores. Perfectamente dimensionado seg√∫n normas IEC 60076 con todas las especificaciones t√©cnicas.',specs:{Software:'SolidWorks 2021+',Escala:'1:1 (param√©trica)','Componentes':'>150 piezas','Peso aprox':'8.5 toneladas',Potencia:'500 KVA',Voltaje:'13.2kV/0.48kV'},features:['Modelo 3D completo y detallado','Componentes individuales editables','Planos t√©cnicos en 2D','Especificaciones el√©ctricas','Lista de materiales (BOM)','Ensamblaje funcional','Dimensiones exactas seg√∫n normas'],images:['https://images.unsplash.com/photo-1558618047-3c8c76ca7d13?w=800','https://images.unsplash.com/photo-1581094794329-c8112a89af12?w=800','https://images.unsplash.com/photo-1558618666-fcd25c85cd64?w=800','https://images.unsplash.com/photo-1581291518857-4e27b48ff24e?w=800']},
            3: {name:'Set Engranajes Industriales',price:49.99,category:'Piezas Mec√°nicas',format:'SolidWorks',badge:'SolidWorks 3D',desc:'Biblioteca con 20 engranajes rectos y helicoidales, diferentes m√≥dulos y n√∫meros de dientes. Modelos 3D editables con par√°metros de dise√±o.',longDesc:'Conjunto completo de 20 modelos 3D de engranajes industriales. Incluye engranajes rectos (m√≥dulos 1-6) y helicoidales con diferentes √°ngulos de presi√≥n. Todos los modelos son completamente param√©tricos y pueden ajustarse seg√∫n tus especificaciones de dise√±o.',specs:{Software:'SolidWorks 2020+','N√∫mero de modelos':'20 engranajes',M√≥dulos:'1 a 6 mm','Material':'Acero est√°ndar','Precisi√≥n':'Clase 6-7',Formatos:'SLDPRT + SLDASM'},features:['20 engranajes diferentes','Modelos param√©tricos','Rectos y helicoidales','C√°lculos de resistencia incluidos','Simulaci√≥n de engrane','Documentaci√≥n t√©cnica','Listo para an√°lisis FEA'],images:['https://images.unsplash.com/photo-1581094794329-c8112a89af12?w=800','https://images.unsplash.com/photo-1558618666-fcd25c85cd64?w=800','https://images.unsplash.com/photo-1581291518857-4e27b48ff24e?w=800','https://images.unsplash.com/photo-1558618047-3c8c76ca7d13?w=800']}
        };

        let currentProduct = null;
        let quantity = 1;
        let cart = JSON.parse(localStorage.getItem('cart')) || [];

        // Get product from URL
        function init() {
            const params = new URLSearchParams(window.location.search);
            const id = parseInt(params.get('id'));
            currentProduct = productsDB[id];
            
            if(!currentProduct) {
                document.querySelector('main').innerHTML = '<p style="color:var(--muted)">Producto no encontrado</p>';
                return;
            }

            // Populate product data
            document.getElementById('product-badge').textContent = currentProduct.badge;
            document.getElementById('product-name').textContent = currentProduct.name;
            document.getElementById('product-price').textContent = '$' + currentProduct.price.toFixed(2);
            document.getElementById('product-description').textContent = currentProduct.longDesc;

            // Specs
            const specsGrid = document.getElementById('specs-grid');
            Object.entries(currentProduct.specs).forEach(([key,val]) => {
                const el = document.createElement('div');
                el.className = 'spec-item';
                el.innerHTML = `<div class="spec-label">${key}</div><div class="spec-value">${val}</div>`;
                specsGrid.appendChild(el);
            });

            // Features
            const featuresList = document.getElementById('features-list');
            currentProduct.features.forEach(f => {
                const li = document.createElement('li');
                li.textContent = f;
                featuresList.appendChild(li);
            });

            updateCartUI();
            initGallery(currentProduct.images);
        }

        function switchTab(tab) {
            document.querySelectorAll('.tab-content').forEach(el => el.classList.remove('active'));
            document.querySelectorAll('.tab').forEach(el => el.classList.remove('active'));
            document.getElementById(tab).classList.add('active');
            event.target.classList.add('active');
        }

        function increaseQty() { quantity++; document.getElementById('qty').textContent = quantity; }
        function decreaseQty() { if(quantity > 1) quantity--; document.getElementById('qty').textContent = quantity; }

        function addToCartFinal() {
            const existing = cart.find(i => i.name === currentProduct.name);
            if(existing) existing.quantity += quantity;
            else cart.push({id: Object.keys(productsDB).find(k => productsDB[k].name === currentProduct.name), name: currentProduct.name, price: currentProduct.price, format: currentProduct.format, quantity: quantity});
            saveCart();
            updateCartUI();
            quantity = 1;
            document.getElementById('qty').textContent = quantity;
            showNotification(currentProduct.name + ' agregado al carrito');
        }

        function saveCart() { localStorage.setItem('cart', JSON.stringify(cart)); }
        function updateCartUI() {
            const container = document.getElementById('cart-items');
            const countEl = document.getElementById('cart-count');
            if(!cart.length) {
                container.innerHTML = '<div class="cart-empty">Tu carrito est√° vac√≠o</div>';
                countEl.style.display = 'none';
            } else {
                container.innerHTML = '';
                cart.forEach(item => {
                    const el = document.createElement('div');
                    el.style.cssText = 'display:flex;justify-content:space-between;align-items:center;padding:.6rem 0;border-bottom:1px solid rgba(255,255,255,0.04)';
                    el.innerHTML = `<div><div style="font-weight:700">${item.name}</div><div style="color:var(--muted);font-size:.9rem">${item.format}</div></div><div style="text-align:right"><div style="color:var(--accent1);font-weight:700">$${(item.price*item.quantity).toFixed(2)}</div><div style="font-size:.9rem;color:var(--muted)">${item.quantity}x</div></div>`;
                    container.appendChild(el);
                });
                countEl.style.display = 'flex';
                countEl.textContent = cart.reduce((s,i) => s+i.quantity, 0);
            }
            updateSummary();
        }

        function updateSummary() {
            const subtotal = cart.reduce((s,i) => s + i.price*i.quantity, 0);
            const tax = subtotal * 0.10;
            const total = subtotal + tax;
            document.getElementById('subtotal').textContent = '$' + subtotal.toFixed(2);
            document.getElementById('tax').textContent = '$' + tax.toFixed(2);
            document.getElementById('total').textContent = '$' + total.toFixed(2);
        }

        function toggleCart() {
            document.getElementById('cart-modal').classList.toggle('active');
            document.getElementById('cart-overlay').classList.toggle('active');
        }

        function checkout() {
            if(!cart.length) { alert('Tu carrito est√° vac√≠o'); return; }
            window.location.href = 'checkout.html';
        }

        function showNotification(msg) {
            const n = document.createElement('div');
            n.textContent = msg;
            n.style.cssText = 'position:fixed;top:90px;right:20px;background:linear-gradient(135deg,var(--accent1),var(--accent2));color:#fff;padding:.8rem 1rem;border-radius:8px;z-index:2000;animation:slideIn .3s';
            document.body.appendChild(n);
            setTimeout(() => { n.style.animation = 'slideOut .3s'; setTimeout(() => n.remove(), 300); }, 2200);
        }

        // Add animations
        const style = document.createElement('style');
        style.textContent = `@keyframes slideIn{from{transform:translateX(400px);opacity:0}to{transform:translateX(0);opacity:1}}@keyframes slideOut{from{transform:translateX(0);opacity:1}to{transform:translateX(400px);opacity:0}}`;
        document.head.appendChild(style);

        // Gallery functionality
        let currentImageIndex = 0;
        let productImages = [];

        function initGallery(images) {
            productImages = images;
            currentImageIndex = 0;
            updateGallery();
        }

        function updateGallery() {
            if (!productImages.length) return;

            const mainImg = document.getElementById('gallery-main-img');
            const thumbnails = document.getElementById('gallery-thumbnails');

            mainImg.src = productImages[currentImageIndex];
            mainImg.onclick = openLightbox;

            thumbnails.innerHTML = '';
            productImages.forEach((img, index) => {
                const thumb = document.createElement('img');
                thumb.src = img;
                thumb.onclick = () => setImage(index);
                if (index === currentImageIndex) thumb.classList.add('active');
                thumbnails.appendChild(thumb);
            });
        }

        function setImage(index) {
            currentImageIndex = index;
            updateGallery();
        }

        function changeImage(direction) {
            currentImageIndex = (currentImageIndex + direction + productImages.length) % productImages.length;
            updateGallery();
        }

        function openLightbox() {
            const lightbox = document.createElement('div');
            lightbox.className = 'lightbox active';
            lightbox.innerHTML = `
                <button class="lightbox-close" onclick="this.parentElement.remove()">√ó</button>
                <div class="lightbox-nav">
                    <button onclick="changeLightboxImage(-1)">‚Äπ</button>
                    <button onclick="changeLightboxImage(1)">‚Ä∫</button>
                </div>
                <img src="${productImages[currentImageIndex]}" alt="Producto ampliado">
            `;
            document.body.appendChild(lightbox);

            // Keyboard navigation
            const keyHandler = (e) => {
                if (e.key === 'Escape') lightbox.remove();
                if (e.key === 'ArrowLeft') changeLightboxImage(-1);
                if (e.key === 'ArrowRight') changeLightboxImage(1);
            };
            document.addEventListener('keydown', keyHandler);
            lightbox.addEventListener('click', (e) => {
                if (e.target === lightbox) lightbox.remove();
            });
        }

        function changeLightboxImage(direction) {
            const lightbox = document.querySelector('.lightbox');
            if (!lightbox) return;

            currentImageIndex = (currentImageIndex + direction + productImages.length) % productImages.length;
            lightbox.querySelector('img').src = productImages[currentImageIndex];
        }

        init();
    </script>
</body>
</html>
